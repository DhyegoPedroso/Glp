<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/estrutura/template.xhtml">


    <ui:define name="title">Relatório</ui:define>

    <ui:define name="content">

        <h:form id="formRelatorio">

            <p:messages id="mens" >
                <p:autoUpdate/>
            </p:messages>

            <p:toolbar id="toolbar_salvar" styleClass="toolbar">

                <p:toolbarGroup  >

                    <p:commandButton value="Pesquisar" actionListener="#{relatorioC.pesquisarPedido()}" process="@this" />

                    <p:separator/>

                    <p:commandButton value="Limpar Dados" update="formRelatorio" process="@this" />

                </p:toolbarGroup>

            </p:toolbar>

            <p:panelGrid id="dadosPesquisa" columns="1" layout="grid" columnClasses="ui-grid-col-12"
                         styleClass="painel_grid_noborder"  >

                <p:selectOneRadio id="tipoPesquisa" value="#{relatorioC.qualPesquisa}" >
                    <f:selectItem itemLabel="Pedido" itemValue="true"  />
                    <f:selectItem itemLabel="Produto" itemValue="false" />
                    <p:ajax update="dadosPesquisa, tabelaProduto, tabelaPedido" event="change"/>
                </p:selectOneRadio>

                <p:separator/>

                <p:outputLabel for="dateInicial" value="Data Iníco:" />
                <p:calendar id="dateInicial" value="#{relatorioC.dataInicio}" showOn="button" />

                <p:outputLabel for="dateFinal" value="Data Final:" />
                <p:calendar id="dateFinal" value="#{relatorioC.dataFinal}" showOn="button"/>

                <p:outputLabel for="pesqPedido" value="Cliente: " rendered="#{relatorioC.qualPesquisa == true}" />
                <p:inputText id="pesqPedido" value="#{relatorioC.nomeCliente}" rendered="#{relatorioC.qualPesquisa == true}" />

                <p:outputLabel for="pesqProduto" value="Produto: " rendered="#{relatorioC.qualPesquisa == false}" />
                <p:inputText id="pesqProduto" value="#{relatorioC.nomeProduto}" rendered="#{relatorioC.qualPesquisa == false}" />

                <p:separator rendered="#{relatorioC.qualPesquisa == true}"/>

                <p:dataTable id="tabelaPedido" value="#{pedidoC.modelPedido}" var="pedido" reflow="true"
                             style="margin-top: 20px;"  emptyMessage="Nenhum pedido encontrado"
                             rendered="#{relatorioC.qualPesquisa == true}">

                    <f:facet name="header">
                        Pedidos
                    </f:facet>

                    <p:column headerText="Cliente" sortBy="#{pedido.cliente.nomeSocial}">
                        <p:outputLabel value="#{pedido.cliente.nomeSocial}" />
                    </p:column>

                    <p:column headerText="CNPJ" sortBy="#{pedido.cliente.cnpj}">
                        <p:outputLabel value="#{pedido.cliente.cnpj}" />
                    </p:column>

                    <p:column headerText="Placa do Veículo" sortBy="#{pedido.caminhao.placaCaminhao}">
                        <p:outputLabel value="#{pedido.caminhao.placaCaminhao}" />
                    </p:column>

                    <p:column headerText="Nome do Motorista" sortBy="#{pedido.caminhao.nomeMotorista}">
                        <p:outputLabel value="#{pedido.caminhao.nomeMotorista}" />
                    </p:column>

                    <p:column headerText="Data do Pedido" sortBy="#{pedido.cadastro}">
                        <p:outputLabel value="#{pedido.cadastro}" >
                            <f:convertDateTime pattern="dd/MM/yyyy" locale="pt-BR"/>
                        </p:outputLabel>
                    </p:column>

                </p:dataTable>

                <p:separator rendered="#{relatorioC.qualPesquisa == true}"/>

                <p:separator rendered="#{relatorioC.qualPesquisa == false}"/>

                <p:dataTable id="tabelaProduto" value="#{pedidoC.modelItemProdutos}" var="itemPedido" reflow="true"
                             style="margin-top: 20px;"  emptyMessage="Nenhum produto encontrado" 
                             rendered="#{relatorioC.qualPesquisa == false}">

                    <f:facet name="header">
                        Produtos
                    </f:facet>

                    <p:column headerText="Produto" sortBy="#{itemPedido.produto.nomeProduto}">
                        <p:outputLabel value="#{itemPedido.produto.nomeProduto}" />
                    </p:column>

                    <p:column headerText="Situação" sortBy="#{itemPedido.produto.situacao}">
                        <p:outputLabel value="#{itemPedido.produto.situacao}" />
                    </p:column>

                    <p:column headerText="Marca" sortBy="#{itemPedido.produto.marca}">
                        <p:outputLabel value="#{itemPedido.produto.marca}" />
                    </p:column>

                    <p:column headerText="Quantidade" sortBy="#{itemPedido.produto.quantidade}">
                        <p:outputLabel value="#{itemPedido.produto.quantidade}" />
                    </p:column>

                    <p:column headerText="Data do Pedido" sortBy="#{itemPedido.pedido.cadastro}">
                        <p:outputLabel value="#{itemPedido.pedido.cadastro}" >
                            <f:convertDateTime pattern="dd/MM/yyyy" locale="pt-BR"/>
                        </p:outputLabel>
                    </p:column>

                </p:dataTable>

                <p:separator rendered="#{relatorioC.qualPesquisa == false}"/>

            </p:panelGrid>

        </h:form>


        <script type="text/javascript">
            PrimeFaces.locales['pt-BR'] = {
                closeText: 'Perto',
                prevText: 'de Volta',
                nextText: 'Mais',
                monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                dayNames: ['Domingo', 'Segunda-Feira', 'Terça-Feira', 'Quarta-Feira', 'Quinta-Feira', 'Sexta-Feira', 'Sábado'],
                dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab'],
                dayNamesMin: ['D', 'S', 'T', 'Q ', 'Q', 'S ', 'S'],
                weekHeader: 'Semana',
                FirstDay: 1,
                isRTL: false,
                showMonthAfterYear: false,
                yearSuffix: '',
                timeOnlyTitle: 'Só Tempo',
                timeText: 'Tempo',
                hourText: 'Hora',
                minuteText: 'Minuto',
                secondText: 'Segundo',
                currentText: 'Data Atual',
                ampm: false,
                month: 'Mês',
                week: 'Semana',
                day: 'Dia',
                allDayText: 'Dia Inteiro'
            };
        </script>

        <style type="text/css">
            .value {
                font-weight: bold;
            }
        </style>

    </ui:define>

</ui:composition>